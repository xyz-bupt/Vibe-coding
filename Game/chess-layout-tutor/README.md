# 🏮 象棋布局教学系统

基于《象棋布局全书》(李中健、刘海亭) 的互动式象棋布局教学应用。

## 🚀 快速开始

### 一键启动（推荐）

```bash
npm start
```

**服务器将自动启动并在浏览器中打开应用！**

- 开发服务器地址：http://localhost:3000/
- 如果端口被占用，自动切换到：http://localhost:3001/

### 其他启动方式

```bash
npm run dev
```

---

## ✨ 功能特点

### 已完成功能

- 📚 **100个精选布局**：按6章节组织，涵盖从基础到高级的完整布局库
  - 第1章：顺手炮（20局）
  - 第2章：列手炮（15局）
  - 第3章：中炮对屏风马（20局）
  - 第4章：中炮对反宫马（15局）
  - 第5章：仙人指路（20局）
  - 第6章：飞相局等（10局）

- 🎬 **分步移动演示**：红方→黑方，清晰展示每一步
  - 显示轮次指示器（"红方走棋"/"黑方走棋"）
  - 当前移动方高亮显示
  - 自动播放功能（可调节速度）

- 🎨 **移动动画效果**：视觉化的移动过程
  - 源位置：半透明高亮
  - 目标位置：明显高亮（带边框）
  - 根据移动方显示对应颜色（红/黑）

- 📂 **章节分组导航**：可折叠的章节组织
  - 点击章节标题展开/折叠
  - 显示章节数量和描述
  - 默认展开第1章

- 🖥️ **稳定的界面**：无跳动，无闪烁
  - 固定高度容器
  - 优化的CSS布局
  - 流畅的用户体验

- ⚠️ **陷阱识别**：学习常见陷阱和飞刀战术
- 💡 **详细讲解**：每一步都有注释说明
- ⭐ **难度分级**：1-5星，适合不同水平棋手

---

## 🎮 使用指南

### 学习一个布局

1. **选择布局**：在左侧面板点击任意章节，浏览并选择一个布局
2. **查看介绍**：选中布局后，右侧会显示布局说明和要点
3. **开始学习**：使用播放控制按钮逐步学习
   - ⏮️ 回到开始
   - ◀️ 上一步
   - ▶️/⏸️ 播放/暂停
   - ▶️ 下一步
   - ⏭️ 跳到最后
4. **观察移动**：每一步都会显示
   - 当前回合数
   - 红方和黑方的棋谱
   - 移动的讲解注释
   - 陷阱提示（如果有）

### 理解棋谱记法

- **炮二平五**：炮从第2路平移到第5路
- **马８进７**：马从第8路前进1步到第7路
- **车一平二**：车从第1路平移到第2路

### 难度说明

- ⭐（1星）：初学者，基本布局
- ⭐⭐（2星）：入门，常见变化
- ⭐⭐⭐（3星）：中级，进阶技巧
- ⭐⭐⭐⭐（4星）：中高级，复杂对攻
- ⭐⭐⭐⭐⭐（5星）：高级，高手对决

**建议**：从简单到复杂逐步学习

---

## 🛠️ 技术栈

- **前端框架**：React 18 + TypeScript
- **构建工具**：Vite 5
- **状态管理**：Zustand
- **UI组件**：纯CSS + 内联样式
- **代码质量**：TypeScript严格模式，ESLint

---

## 📊 项目结构

```
chess-layout-tutor/
├── src/
│   ├── components/          # React组件
│   │   ├── Board/          # 棋盘组件（Canvas渲染）
│   │   │   ├── ChessBoard.tsx       # 主棋盘组件
│   │   │   └── ChessBoard.css        # 棋盘样式
│   │   ├── LayoutList/     # 布局列表（章节分组）
│   │   │   └── LayoutList.tsx        # 布局列表
│   │   └── MoveController/ # 移动控制器（播放按钮）
│   │       ├── MoveControllerSafe.tsx  # 安全版控制器（带自动播放）
│   │       ├── MoveControllerBasic.tsx # 基础版控制器（无自动播放）
│   │       ├── MoveControllerSimple.tsx # 简化版控制器（调试用）
│   │       └── MoveController.css      # 控制样式
│   ├── data/
│   │   └── chapters/       # 6章×100局布局数据
│   │       ├── chapter01-shunshunpao.ts    # 顺手炮
│   │       ├── chapter02-lieshoupao.ts     # 列手炮
│   │       ├── chapter03-zhongpao-pingfengma.ts  # 屏风马
│   │       ├── chapter04-zhongpao-fangongma.ts  # 反宫马
│   │       ├── chapter05-xianrenzhilu.ts  # 仙人指路
│   │       ├── chapter06-feixiangju.ts    # 飞相局
│   │       └── index.ts                  # 元数据导出
│   ├── core/              # 核心逻辑
│   │   └── board.ts       # 棋盘逻辑
│   ├── store/             # Zustand状态管理
│   │   └── appStore.ts    # 应用状态
│   ├── types/             # TypeScript类型定义
│   │   └── index.ts       # 完整类型系统
│   ├── utils/             # 工具函数
│   │   └── notationParser.ts  # 棋谱解析器
│   ├── App.tsx            # 主应用组件
│   ├── App.css            # 全局样式
│   └── main.tsx           # 入口文件
├── public/                # 静态资源
│   └── assets/pieces/     # 棋子图片（PNG）
├── index.html
├── package.json           # 项目配置
├── vite.config.ts         # Vite配置
└── tsconfig.json          # TypeScript配置
```

---

## 🔧 开发命令

```bash
# 启动开发服务器（自动打开浏览器）✨
npm start

# 或使用dev命令
npm run dev

# 构建生产版本
npm run build

# 预览生产构建
npm run preview

# 代码检查
npm run lint
```

---

## 📝 数据结构

### 布局数据格式

```typescript
interface Layout {
  id: string;              // 布局ID (001-100)
  name: string;            // 布局名称
  category: LayoutCategory; // 分类
  difficulty: 1-5;         // 难度等级
  moves: Move[];           // 棋谱
  description: string;     // 描述
  keyPoints: string[];     // 要点
  traps?: Trap[];          // 陷阱
  tags: string[];          // 标签
  chapterId: string;       // 所属章节ID
  chapterNumber: number;   // 章节编号
}
```

### 着法数据格式

```typescript
interface Move {
  round: number;
  red: {
    notation: string;      // "炮二平五"
    note?: string;         // 讲解
  };
  black: {
    notation: string;      // "马8进7"
    note?: string;         // 讲解
  };
}
```

---

## 🎯 开发进度

- [x] 基础项目框架
- [x] 棋盘渲染（Canvas）
- [x] 布局列表（章节分组）
- [x] 播放控制（分步移动）
- [x] 棋谱解析（完整逻辑）
- [x] 移动动画（高亮效果）
- [x] 100个布局数据
- [x] 自动播放功能
- [x] 代码质量优化（9.0/10）
- [ ] 用户进度系统（计划中）
- [ ] AI对弈功能（计划中）

---

## 📈 学习建议

### 初学者路径

1. **第1章（顺手炮）**：最适合初学者
   - 从难度1-2的布局开始
   - 理解基本的开局原则
   - 掌握中炮的运用

2. **第5章（仙人指路）**：灵活多变
   - 难度较低（1-3星）
   - 适合学习开局试探
   - 培养全盘思维

### 进阶路径

3. **第2、3、4章**：进阶学习
   - 包含更复杂的对攻
   - 需要一定的基础
   - 建议按顺序学习

4. **第6章（飞相局）**：防守反击
   - 需要较好的基本功
   - 学习后发制人
   - 适合中高级棋手

---

## 🐛 已知问题

目前应用运行良好，无重大bug。如果您发现任何问题，请报告：

1. **棋谱记法**：使用中文象棋标准记法
2. **坐标系统**：红方从右到左（1-9），黑方从左到右（1-9）
3. **回合顺序**：红方先行，黑方后行

---

## 📚 参考资源

- 《象棋布局全书》(李中健、刘海亭)
- 中国象棋规则
- 现有象棋游戏代码 (./中国象棋游戏)

---

## 📄 许可证

MIT

---

**版本**：v1.1.0
**最后更新**：2026-01-14
**开发**：Claude Code + AI Agents
**代码质量**：9.0/10 ⭐

## 🔧 更新日志

### v1.1.0 (2026-01-14)
- ✅ 修复MoveController组件的白屏问题
- ✅ 创建SafeMoveController替代原有实现
- ✅ 优化状态管理，避免无限循环
- ✅ 改进自动播放逻辑
- ✅ 简化组件props接口

### v1.0.0 (2026-01-13)
- ✅ 初始版本发布
- ✅ 完整的100个布局数据
- ✅ 基础播放功能
- ✅ 自动播放功能
